!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("basekits"),require("event-emitter-object")):"function"==typeof define&&define.amd?define(["basekits","event-emitter-object"],e):(t=t||self).LocalStoragePro=e(t.Basekits,t.EventEmitterObject)}(this,(function(t,e){"use strict";e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(t,e){return t(e={exports:{}},e.exports),e.exports}var o=function(t){return t&&t.Math==Math&&t},i=o("object"==typeof globalThis&&globalThis)||o("object"==typeof window&&window)||o("object"==typeof self&&self)||o("object"==typeof r&&r)||Function("return this")(),u=function(t){try{return!!t()}catch(t){return!0}},c=!u((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),a={}.propertyIsEnumerable,f=Object.getOwnPropertyDescriptor,s={f:f&&!a.call({1:2},1)?function(t){var e=f(this,t);return!!e&&e.enumerable}:a},l=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},p={}.toString,h=function(t){return p.call(t).slice(8,-1)},y="".split,g=u((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==h(t)?y.call(t,""):Object(t)}:Object,d=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},v=function(t){return g(d(t))},w=function(t){return"object"==typeof t?null!==t:"function"==typeof t},m=function(t,e){if(!w(t))return t;var r,n;if(e&&"function"==typeof(r=t.toString)&&!w(n=r.call(t)))return n;if("function"==typeof(r=t.valueOf)&&!w(n=r.call(t)))return n;if(!e&&"function"==typeof(r=t.toString)&&!w(n=r.call(t)))return n;throw TypeError("Can't convert object to primitive value")},b={}.hasOwnProperty,S=function(t,e){return b.call(t,e)},O=i.document,E=w(O)&&w(O.createElement),j=!c&&!u((function(){return 7!=Object.defineProperty((t="div",E?O.createElement(t):{}),"a",{get:function(){return 7}}).a;var t})),k=Object.getOwnPropertyDescriptor,A={f:c?k:function(t,e){if(t=v(t),e=m(e,!0),j)try{return k(t,e)}catch(t){}if(S(t,e))return l(!s.f.call(t,e),t[e])}},P=function(t){if(!w(t))throw TypeError(String(t)+" is not an object");return t},I=Object.defineProperty,T={f:c?I:function(t,e,r){if(P(t),e=m(e,!0),P(r),j)try{return I(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},_=c?function(t,e,r){return T.f(t,e,l(1,r))}:function(t,e,r){return t[e]=r,t},L=function(t,e){try{_(i,t,e)}catch(r){i[t]=e}return e},x=i["__core-js_shared__"]||L("__core-js_shared__",{}),D=Function.toString;"function"!=typeof x.inspectSource&&(x.inspectSource=function(t){return D.call(t)});var R,C,N,K,M=x.inspectSource,V=i.WeakMap,Y="function"==typeof V&&/native code/.test(M(V)),F=n((function(t){(t.exports=function(t,e){return x[t]||(x[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.5",mode:"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})})),G=0,z=Math.random(),W=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++G+z).toString(36)},q=F("keys"),B={},U=i.WeakMap;if(Y){var H=new U,J=H.get,Q=H.has,X=H.set;R=function(t,e){return X.call(H,t,e),e},C=function(t){return J.call(H,t)||{}},N=function(t){return Q.call(H,t)}}else{var Z=q[K="state"]||(q[K]=W(K));B[Z]=!0,R=function(t,e){return _(t,Z,e),e},C=function(t){return S(t,Z)?t[Z]:{}},N=function(t){return S(t,Z)}}var $,tt,et={set:R,get:C,has:N,enforce:function(t){return N(t)?C(t):R(t,{})},getterFor:function(t){return function(e){var r;if(!w(e)||(r=C(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return r}}},rt=n((function(t){var e=et.get,r=et.enforce,n=String(String).split("String");(t.exports=function(t,e,o,u){var c=!!u&&!!u.unsafe,a=!!u&&!!u.enumerable,f=!!u&&!!u.noTargetGet;"function"==typeof o&&("string"!=typeof e||S(o,"name")||_(o,"name",e),r(o).source=n.join("string"==typeof e?e:"")),t!==i?(c?!f&&t[e]&&(a=!0):delete t[e],a?t[e]=o:_(t,e,o)):a?t[e]=o:L(e,o)})(Function.prototype,"toString",(function(){return"function"==typeof this&&e(this).source||M(this)}))})),nt=i,ot=function(t){return"function"==typeof t?t:void 0},it=function(t,e){return arguments.length<2?ot(nt[t])||ot(i[t]):nt[t]&&nt[t][e]||i[t]&&i[t][e]},ut=Math.ceil,ct=Math.floor,at=function(t){return isNaN(t=+t)?0:(t>0?ct:ut)(t)},ft=Math.min,st=function(t){return t>0?ft(at(t),9007199254740991):0},lt=Math.max,pt=Math.min,ht=function(t,e){var r=at(t);return r<0?lt(r+e,0):pt(r,e)},yt=function(t){return function(e,r,n){var o,i=v(e),u=st(i.length),c=ht(n,u);if(t&&r!=r){for(;u>c;)if((o=i[c++])!=o)return!0}else for(;u>c;c++)if((t||c in i)&&i[c]===r)return t||c||0;return!t&&-1}},gt={includes:yt(!0),indexOf:yt(!1)},dt=gt.indexOf,vt=function(t,e){var r,n=v(t),o=0,i=[];for(r in n)!S(B,r)&&S(n,r)&&i.push(r);for(;e.length>o;)S(n,r=e[o++])&&(~dt(i,r)||i.push(r));return i},wt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],mt=wt.concat("length","prototype"),bt={f:Object.getOwnPropertyNames||function(t){return vt(t,mt)}},St={f:Object.getOwnPropertySymbols},Ot=it("Reflect","ownKeys")||function(t){var e=bt.f(P(t)),r=St.f;return r?e.concat(r(t)):e},Et=function(t,e){for(var r=Ot(e),n=T.f,o=A.f,i=0;i<r.length;i++){var u=r[i];S(t,u)||n(t,u,o(e,u))}},jt=/#|\.prototype\./,kt=function(t,e){var r=Pt[At(t)];return r==Tt||r!=It&&("function"==typeof e?u(e):!!e)},At=kt.normalize=function(t){return String(t).replace(jt,".").toLowerCase()},Pt=kt.data={},It=kt.NATIVE="N",Tt=kt.POLYFILL="P",_t=kt,Lt=A.f,xt=function(t,e){var r,n,o,u,c,a=t.target,f=t.global,s=t.stat;if(r=f?i:s?i[a]||L(a,{}):(i[a]||{}).prototype)for(n in e){if(u=e[n],o=t.noTargetGet?(c=Lt(r,n))&&c.value:r[n],!_t(f?n:a+(s?".":"#")+n,t.forced)&&void 0!==o){if(typeof u==typeof o)continue;Et(u,o)}(t.sham||o&&o.sham)&&_(u,"sham",!0),rt(r,n,u,t)}},Dt=Object.defineProperty,Rt={},Ct=function(t){throw t},Nt=function(t,e){if(S(Rt,t))return Rt[t];e||(e={});var r=[][t],n=!!S(e,"ACCESSORS")&&e.ACCESSORS,o=S(e,0)?e[0]:Ct,i=S(e,1)?e[1]:void 0;return Rt[t]=!!r&&!u((function(){if(n&&!c)return!0;var t={length:-1};n?Dt(t,1,{enumerable:!0,get:Ct}):t[1]=1,r.call(t,o,i)}))},Kt=gt.indexOf,Mt=[].indexOf,Vt=!!Mt&&1/[1].indexOf(1,-0)<0,Yt=!!(tt=[]["indexOf"])&&u((function(){tt.call(null,$||function(){throw 1},1)})),Ft=Nt("indexOf",{ACCESSORS:!0,1:0});xt({target:"Array",proto:!0,forced:Vt||!Yt||!Ft},{indexOf:function(t){return Vt?Mt.apply(this,arguments)||0:Kt(this,t,arguments.length>1?arguments[1]:void 0)}});var Gt=Object.keys||function(t){return vt(t,wt)};xt({target:"Object",stat:!0,forced:u((function(){Gt(1)}))},{keys:function(t){return Gt(function(t){return Object(d(t))}(t))}});var zt=!!Object.getOwnPropertySymbols&&!u((function(){return!String(Symbol())})),Wt=zt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,qt=F("wks"),Bt=i.Symbol,Ut=Wt?Bt:Bt&&Bt.withoutSetter||W,Ht=function(t){return S(qt,t)||(zt&&S(Bt,t)?qt[t]=Bt[t]:qt[t]=Ut("Symbol."+t)),qt[t]},Jt={};Jt[Ht("toStringTag")]="z";var Qt="[object z]"===String(Jt),Xt=Ht("toStringTag"),Zt="Arguments"==h(function(){return arguments}()),$t=Qt?h:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),Xt))?r:Zt?h(e):"Object"==(n=h(e))&&"function"==typeof e.callee?"Arguments":n},te=Qt?{}.toString:function(){return"[object "+$t(this)+"]"};Qt||rt(Object.prototype,"toString",te,{unsafe:!0});var ee=function(){var t=P(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e},re=RegExp.prototype,ne=re.toString,oe=u((function(){return"/a/b"!=ne.call({source:"a",flags:"b"})})),ie="toString"!=ne.name;(oe||ie)&&rt(RegExp.prototype,"toString",(function(){var t=P(this),e=String(t.source),r=t.flags;return"/"+e+"/"+String(void 0===r&&t instanceof RegExp&&!("flags"in re)?ee.call(t):r)}),{unsafe:!0});var ue,ce,ae=Array.isArray||function(t){return"Array"==h(t)},fe=function(t,e,r){var n=m(e);n in t?T.f(t,n,l(0,r)):t[n]=r},se=it("navigator","userAgent")||"",le=i.process,pe=le&&le.versions,he=pe&&pe.v8;he?ce=(ue=he.split("."))[0]+ue[1]:se&&(!(ue=se.match(/Edge\/(\d+)/))||ue[1]>=74)&&(ue=se.match(/Chrome\/(\d+)/))&&(ce=ue[1]);var ye=ce&&+ce,ge=Ht("species"),de=function(t){return ye>=51||!u((function(){var e=[];return(e.constructor={})[ge]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}("slice"),ve=Nt("slice",{ACCESSORS:!0,0:0,1:2}),we=Ht("species"),me=[].slice,be=Math.max;function Se(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.error=null,this.window=t.window}function Oe(){this.error=null,this.data={}}function Ee(){e.call(this,{}),this.window=void 0,this.setWindow("undefined"==typeof window?void 0:window),this.drivers={},this.driver=null,this.addDriver("memory",Oe),this.addDriver("localStorage",Se)}return xt({target:"Array",proto:!0,forced:!de||!ve},{slice:function(t,e){var r,n,o,i=v(this),u=st(i.length),c=ht(t,u),a=ht(void 0===e?u:e,u);if(ae(i)&&("function"!=typeof(r=i.constructor)||r!==Array&&!ae(r.prototype)?w(r)&&null===(r=r[we])&&(r=void 0):r=void 0,r===Array||void 0===r))return me.call(i,c,a);for(n=new(void 0===r?Array:r)(be(a-c,0)),o=0;c<a;c++,o++)c in i&&fe(n,o,i[c]);return n.length=o,n}}),Se.prototype.test=function(){if(void 0===this.window)return!1;if("localStorage"in this.window){try{this.window.localStorage.setItem("test","pass"),this.window.localStorage.removeItem("test")}catch(t){return!1}return!0}return!1},Se.prototype.clearError=function(){this.error=null},Se.prototype.set=function(e,r,n){var o=t.functionkit.stringify(r);try{this.window.localStorage.setItem(e,o);var i=t.typekit.getType(r);this.window.localStorage.setItem("LOCALSTORAGEPRO_TYPE_"+e,i)}catch(t){return this.error=t,!1}return!0},Se.prototype.get=function(e,r){var n=this.window.localStorage.getItem("LOCALSTORAGEPRO_TYPE_"+e);if("string"==typeof n&&n.length>0){var o=this.window.localStorage.getItem(e);return t.functionkit.destringify(o,n)}return this.window.localStorage.getItem(e)},Se.prototype.remove=function(t){return this.window.localStorage.removeItem(t),this.window.localStorage.removeItem("LOCALSTORAGEPRO_TYPE_"+t),!0},Se.prototype.clear=function(){return this.window.localStorage.clear(),!0},Se.prototype.length=function(){return this.window.localStorage.length/2},Se.prototype.key=function(t){return this.window.localStorage(t)},Se.prototype.json=function(t){for(var e={},r=0;r<2*this.length();r++){var n=this.window.localStorage.key(r);n.length>21&&"LOCALSTORAGEPRO_TYPE_"==n.slice(0,21)||(e[n]=this.get(n,t))}return e},Oe.prototype.test=function(){return!0},Oe.prototype.clearError=function(){this.error=null},Oe.prototype.set=function(t,e){return this.data[t]=e,!0},Oe.prototype.get=function(t){return this.data.hasOwnProperty(t)?this.data[t]:null},Oe.prototype.remove=function(t){if(!this.data.hasOwnProperty(t))return null;for(var e=Object.keys(this.data),r={},n=0;n<e.length;n++){var o=e[n];o!=t&&(r[o]=this.data[o])}return this.data=r,!0},Oe.prototype.clear=function(){return this.data={},!0},Oe.prototype.length=function(){return Object.keys(this.data).length},Oe.prototype.key=function(t){var e=Object.keys(this.data);return t<e.length&&t>=0?e[t]:null},Oe.prototype.json=function(){return this.data},Ee.prototype=Object.create(e.prototype),Ee.prototype.constructor=Ee,Ee.prototype.length=0,Ee.prototype.setWindow=function(t){this.window=t},Ee.prototype.addDriver=function(t,e){var r=new e({window:this.window});!0===r.test()&&(this.drivers[t]=r,this.driver=this.drivers[t])},Ee.prototype.setItem=function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.isKeyValid(e)){var o=this.getDriver(n);return o?(o.set(this.formatKey(e),r,this),t.typekit.isError(o.error)?(this.emit("error",new Error("SET_ERROR"),o.error),void o.clearError()):(this.getLength(),!0)):void 0}this.emit("error",new Error("INVALID_KEY"))},Ee.prototype.getItem=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.isKeyValid(t)){var r=this.getDriver(e);if(r){var n=r.get(this.formatKey(t),this);return this.getLength(),n}}else this.emit("error",new Error("INVALID_KEY"))},Ee.prototype.removeItem=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.isKeyValid(t)){var r=this.getDriver(e);if(r)return r.remove(this.formatKey(t)),this.getLength(),!0}else this.emit("error",new Error("INVALID_KEY"))},Ee.prototype.clear=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getDriver(t);return e&&(e.clear(),this.getLength()),!0},Ee.prototype.key=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.getDriver(e);return r?r.getKey(t):null},Ee.prototype.getLength=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getDriver(t);return this.length=e?e.length():0,this.length},Ee.prototype.json=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getDriver(t);return e?e.json(this):0},Ee.prototype.isKeyValid=function(e){return t.typekit.isString(e)&&t.validationkit.isNotEmpty(e)||t.typekit.isNumber(e)},Ee.prototype.formatKey=function(e){return t.typekit.isNumber(e)?e.toString():e},Ee.prototype.availableDrivers=function(){return Object.keys(this.drivers)},Ee.prototype.getDriver=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t.validationkit.isNotEmpty(e)?-1===this.availableDrivers().indexOf(e)?void this.emit("error",new Error("DRIVER_NOT_FOUND")):this.drivers[e]:this.driver},new Ee}));
